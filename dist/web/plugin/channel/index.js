(window.SensorsDataWebJSSDKPlugin=window.SensorsDataWebJSSDKPlugin||{}).SensorsChannel=function(){"use strict";function e(e,n,t){if(n&&(e.plugin_name=n),t&&e.init){var i=e.init;e.init=function(n,a){function r(){i.call(e,n,a)}return n.readyState&&n.readyState.state>=3||!n.on?r():void n.on(t,r)}}return e}function n(n,t,i){return e(n,t,i),n.plugin_version=s,n}var t,i,a,r,s="1.24.14",l={event_list:[],latest_event_initial_time:null,max_save_time:2592e6,init:function(e,n){function s(){return t=i._,a=i.store,!!t.localStorage.isSupport()&&(i.para.max_string_length=1024,l.eventList.init(),l.addLatestChannelUrl(),void l.addIsChannelCallbackEvent())}if(i||!e)return!1;n=n||{},r=n.cookie_name||"sensorsdata2015jssdkchannel",i=e;var l=this;s()},addIsChannelCallbackEvent:function(){i.registerPage({$is_channel_callback_event:function(e){if(t.isObject(e)&&e.event&&"$WebClick"!==e.event&&"$pageview"!==e.event&&"$WebStay"!==e.event&&"$SignUp"!==e.event)return!l.eventList.hasEvent(e.event)&&(l.eventList.add(e.event),!0)}})},addLatestChannelUrl:function(){var e=this.getUrlDomain(),n=this.cookie.getChannel();if("url\u89e3\u6790\u5931\u8d25"===e)this.registerAndSave({_sa_channel_landing_url:"",_sa_channel_landing_url_error:"url\u7684domain\u89e3\u6790\u5931\u8d25"});else if(t.isReferralTraffic(document.referrer)){var a=t.getQueryParam(location.href,"sat_cf");t.isString(a)&&a.length>0?(this.registerAndSave({_sa_channel_landing_url:location.href}),l.channelLinkHandler()):this.registerAndSave({_sa_channel_landing_url:""})}else n?i.registerPage(n):i.registerPage({_sa_channel_landing_url:"",_sa_channel_landing_url_error:"\u53d6\u503c\u5f02\u5e38"})},registerAndSave:function(e){i.registerPage(e),this.cookie.saveChannel(e)},cookie:{getChannel:function(){var e=i.kit.userDecryptIfNeeded(t.cookie.get(r));return e=t.safeJSONParse(e),!(!t.isObject(e)||!e.prop)&&e.prop},saveChannel:function(e){var n={prop:e},a=JSON.stringify(n);i.para.encrypt_cookie&&(a=i.kit.userEncrypt(a)),t.cookie.set(r,a)}},channelLinkHandler:function(){this.eventList.reset(),i.track("$ChannelLinkReaching")},getUrlDomain:function(){var e=t.info.pageProp.url_domain;return""===e&&(e="url\u89e3\u6790\u5931\u8d25"),e},eventList:{init:function(){var e=this.get(),n=(new Date).getTime();if(e&&t.isNumber(e.latest_event_initial_time)&&t.isArray(e.eventList)){var i=n-e.latest_event_initial_time;i>0&&i<l.max_save_time?(l.event_list=e.eventList,l.latest_event_initial_time=e.latest_event_initial_time):this.reset()}else this.reset()},get:function(){var e={};try{e=a.readObjectVal("sawebjssdkchannel")}catch(n){i.log(n)}return e},add:function(e){l.event_list.push(e),this.save()},save:function(){var e={latest_event_initial_time:l.latest_event_initial_time,eventList:l.event_list};a.saveObjectVal("sawebjssdkchannel",e)},reset:function(){l.event_list=[],l.latest_event_initial_time=(new Date).getTime(),this.save()},hasEvent:function(e){var n=!1;return t.each(l.event_list,function(t){t===e&&(n=!0)}),n}}},_=n(l,"SensorsChannel","sdkAfterInitAPI");return _}();