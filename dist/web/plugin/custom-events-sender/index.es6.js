var sd,_,log,sdkversion_placeholder="1.24.14";function wrapPluginInitFn(n,e,t){if(e&&(n.plugin_name=e),t&&n.init){var a=n.init;n.init=function(e,r){if(e.readyState&&e.readyState.state>=3||!e.on)return i();function i(){a.call(n,e,r)}e.on(t,i)}}return n}function createPlugin(n,e,t){return wrapPluginInitFn(n,e,t),n.plugin_version=sdkversion_placeholder,n}function flattenArray(n){var e=[];return _.each(n,function(n){_.isArray(n)?e=e.concat(flattenArray(n)):e.push(_.optimizeServerUrl(n))}),e}function hasEqualServerUrl(n,e){e=_.isArray(e)?e:[e];var t=!1;return _.isArray(n)?_.each(n,function(n){_.indexOf(e,n)>-1&&(t=!0)}):_.indexOf(e,n)>-1&&(t=!0),t}function getSendUrl(n,e){var t=sd.kit.encodeTrackData(e);return-1!==n.indexOf("?")?n+"&"+t:n+"?"+t}var sender={hookFn:null,init:function(n){this.hookFn=n,sd.registerInterceptor("sendDataStage",{send:{priority:20,entry:function(n,e){return sender.sendData(n,e),n}}})},sendData:function(n,e){var t=n.data,a=t.event,r=n.server_url,i=n.callback,o=this,s=this.hookFn({event_name:a,data:_.extend2Lev({identities:{},lib:{},properties:{}},t),server_url:r});return _.isArray(s)&&s.length?(s=flattenArray(s),hasEqualServerUrl(r,s)?i=null:e.cancellationToken.stop(),_.each(s,function(e){if(e&&""!==e&&!hasEqualServerUrl(e,r)){var t=(a=e,function(){o.sendCall({server_url:a,data:n.data,config:null,callback:i}),i=null,n.callback=null});setTimeout(t)}var a}),n):(_.isFunction(i)&&i(),e.cancellationToken.stop(),n)},getInstance:function(n){return"beacon"===sd.para.send_type&&_.isSupportBeaconSend()?(n.data=sd.kit.encodeTrackData(n.data),new _.BeaconSend(n)):"ajax"===sd.para.send_type&&_.isSupportCors()?(n.data=sd.kit.encodeTrackData(n.data),new _.AjaxSend(n)):(n.data.time=1*new Date,n.data=getSendUrl(n.server_url,n.data),new _.ImageSend(n))},sendCall:function(n){this.getInstance(n).start()}},CustomEventsSender={plugin_name:"CustomEventsSender",init:function(n,e){if(_=(sd=n)._,log=sd&&sd.log||console&&console.log||function(){},_.isFunction(e)){if(sd.readyState&&sd.readyState.state>=3||!sd.on)return sender.init(e);sd.on("sdkAfterInitPara",function(){sender.init(e)})}else log("CustomEventsSender init failed\uff0chookFn error. hookFn:",e)}},index=createPlugin(CustomEventsSender);export default index;